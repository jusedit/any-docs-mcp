<!DOCTYPE html>
<html lang="en">
<head><title>Authentication - E2E Test Docs</title></head>
<body>
<nav class="sidebar">
  <a href="/docs/">Home</a>
  <a href="/docs/getting-started">Getting Started</a>
  <a href="/docs/authentication">Authentication</a>
  <a href="/docs/api-reference">API Reference</a>
  <a href="/docs/deployment">Deployment Guide</a>
</nav>
<main>
  <h1>Authentication</h1>
  <p>AnyDocsMCP supports multiple authentication methods to secure your documentation server.</p>

  <h2>API Key Authentication</h2>
  <p>The simplest method is using API keys. Generate a key and include it in the request header:</p>
  <pre><code class="language-bash">curl -H "Authorization: Bearer YOUR_API_KEY" http://localhost:3000/search?q=hooks</code></pre>

  <h3>Generating API Keys</h3>
  <p>Use the CLI to generate a new API key:</p>
  <pre><code class="language-python">from anydocs import auth

key = auth.generate_api_key(name="my-app", scopes=["read", "search"])
print(f"Your API key: {key.token}")
# Store this securely - it cannot be retrieved later</code></pre>

  <h2>OAuth2 Integration</h2>
  <p>For production environments, we recommend OAuth2 with PKCE flow:</p>
  <pre><code class="language-javascript">import { OAuth2Client } from 'anydocs-mcp/auth';

const oauth = new OAuth2Client({
  clientId: process.env.OAUTH_CLIENT_ID,
  redirectUri: 'http://localhost:3000/callback',
  scopes: ['docs:read', 'docs:search']
});

// Redirect user to authorization URL
const authUrl = oauth.getAuthorizationUrl();
console.log('Authorize at:', authUrl);</code></pre>

  <h2>JWT Token Validation</h2>
  <p>All authenticated requests use JWT tokens. The server validates tokens automatically:</p>
  <pre><code class="language-typescript">interface TokenPayload {
  sub: string;       // User ID
  scopes: string[];  // Granted permissions
  exp: number;       // Expiration timestamp
  iat: number;       // Issued at timestamp
}</code></pre>
  <p>Tokens expire after 24 hours by default. Use the refresh token to obtain a new access token without re-authentication.</p>

  <h2>Troubleshooting Authentication</h2>
  <p>Common authentication errors and their solutions:</p>
  <ul>
    <li><strong>401 Unauthorized</strong> - Check that your API key or token is valid and not expired</li>
    <li><strong>403 Forbidden</strong> - Your token lacks the required scope for this operation</li>
    <li><strong>429 Too Many Requests</strong> - You've exceeded the rate limit. Wait and retry.</li>
  </ul>
</main>
</body>
</html>
